



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.9.2">
    
    
      
        <title>Setup - Explicates Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.ba0fd1a6.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#installation" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Explicates Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Explicates Documentation
              </span>
              <span class="md-header-nav__topic">
                Setup
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/alexandermendes/explicates/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      alexandermendes/explicates
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    Explicates Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/alexandermendes/explicates/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      alexandermendes/explicates
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Setup
      </label>
    
    <a href="./" title="Setup" class="md-nav__link md-nav__link--active">
      Setup
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" title="Installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" title="Configuration" class="md-nav__link">
    Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment" title="Deployment" class="md-nav__link">
    Deployment
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-python-and-git" title="Install Python and git" class="md-nav__link">
    Install Python and git
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-and-build-explicates" title="Download and build Explicates" class="md-nav__link">
    Download and build Explicates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup-the-database" title="Setup the database" class="md-nav__link">
    Setup the database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup-nginx" title="Setup NGINX" class="md-nav__link">
    Setup NGINX
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-up-uwsgi" title="Setting up uWSGI" class="md-nav__link">
    Setting up uWSGI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup-up-supervisor" title="Setup Up Supervisor" class="md-nav__link">
    Setup Up Supervisor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security" title="Security" class="md-nav__link">
    Security
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#firewall" title="Firewall" class="md-nav__link">
    Firewall
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secure-sockets-layer-ssl" title="Secure Sockets Layer (SSL)" class="md-nav__link">
    Secure Sockets Layer (SSL)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../collections/" title="Collections" class="md-nav__link">
      Collections
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../annotations/" title="Annotations" class="md-nav__link">
      Annotations
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../search/" title="Search" class="md-nav__link">
      Search
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../export/" title="Export" class="md-nav__link">
      Export
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" title="Installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" title="Configuration" class="md-nav__link">
    Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment" title="Deployment" class="md-nav__link">
    Deployment
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-python-and-git" title="Install Python and git" class="md-nav__link">
    Install Python and git
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-and-build-explicates" title="Download and build Explicates" class="md-nav__link">
    Download and build Explicates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup-the-database" title="Setup the database" class="md-nav__link">
    Setup the database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup-nginx" title="Setup NGINX" class="md-nav__link">
    Setup NGINX
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-up-uwsgi" title="Setting up uWSGI" class="md-nav__link">
    Setting up uWSGI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup-up-supervisor" title="Setup Up Supervisor" class="md-nav__link">
    Setup Up Supervisor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security" title="Security" class="md-nav__link">
    Security
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#firewall" title="Firewall" class="md-nav__link">
    Firewall
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secure-sockets-layer-ssl" title="Secure Sockets Layer (SSL)" class="md-nav__link">
    Secure Sockets Layer (SSL)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/alexandermendes/explicates/edit/master/docs/setup.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Setup</h1>
                
                <p>The following page explains how to get an Explicates server up and running.</p>
<h2 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h2>
<p>A virtual machine setup is provided for local development.</p>
<p>Download and install
<a href="https://www.vagrantup.com/">Vagrant</a> &gt;= 4.2.10 and
<a href="https://www.virtualbox.org/">VirtualBox</a> &gt;= 1.2.1,
then run:</p>
<div class="codehilite"><pre><span></span><span class="c1"># setup vm</span>
vagrant up

<span class="c1"># enter vm</span>
vagrant ssh

<span class="c1"># run</span>
python run.py
</pre></div>

<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">&para;</a></h2>
<p>The contents of the settings template file, <code>settings.py.tmpl</code>, are replicated
below. To edit any of the settings make a copy of the template:</p>
<div class="codehilite"><pre><span></span>cp settings.py.tmpl settings.py
</pre></div>

<p>The comments below indicate where any default values are used.</p>
<div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf8 -*-</span>

<span class="c1"># Development</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">3000</span>

<span class="c1"># ** IMPORTANT: Uncomment the lines below in production **</span>
<span class="c1"># ENV = &#39;production&#39;</span>
<span class="c1"># SERVER_NAME = &#39;example.com&#39;</span>

<span class="c1"># Database URI</span>
<span class="n">SQLALCHEMY_DATABASE_URI</span> <span class="o">=</span> <span class="s1">&#39;postgresql://explicates:tester@localhost/explicates&#39;</span>

<span class="c1"># Database slave configuration</span>
<span class="c1"># SQLALCHEMY_BINDS = {</span>
<span class="c1">#     &#39;slave&#39;: &#39;postgresql://user:password@server/db&#39;</span>
<span class="c1"># }</span>

<span class="c1"># The agent responsible for generating the serialization of the Annotations.</span>
<span class="c1"># See https://www.w3.org/TR/annotation-model/</span>
<span class="c1"># GENERATOR = &#39;http://example.org/client1&#39;</span>

<span class="c1"># Require strict slashes at the end of all API endpoints (default below)</span>
<span class="c1"># STRICT_SLASHES = False</span>

<span class="c1"># The number of Annotations to display per page (default below)</span>
<span class="c1"># ANNOTATIONS_PER_PAGE = 1000</span>

<span class="c1"># CORS settings (defaults below)</span>
<span class="c1"># See https://flask-cors.readthedocs.io/en/latest/</span>
<span class="c1"># CORS_RESOURCES = {</span>
<span class="c1">#     r&quot;/*&quot;: {</span>
<span class="c1">#         &quot;origins&quot;: &quot;*&quot;,</span>
<span class="c1">#         &quot;allow_headers&quot;: [</span>
<span class="c1">#             &#39;Content-Type&#39;,</span>
<span class="c1">#             &#39;Content-Length&#39;,</span>
<span class="c1">#             &#39;Authorization&#39;,</span>
<span class="c1">#             &#39;If-Match&#39;,</span>
<span class="c1">#             &#39;Prefer&#39;,</span>
<span class="c1">#             &#39;Accept&#39;,</span>
<span class="c1">#             &#39;Slug&#39;</span>
<span class="c1">#         ],</span>
<span class="c1">#         &quot;max_age&quot;: 21600,</span>
<span class="c1">#         &quot;supports_credentials&quot;: True</span>
<span class="c1">#     }</span>
<span class="c1"># }</span>

<span class="c1"># Full-text search default language (default below)</span>
<span class="c1"># FTS_DEFAULT = &#39;english&#39;</span>

<span class="c1"># Full-text search map of available PostgreSQL dictionaries (defaults below)</span>
<span class="c1"># FTS_LANGUAGE_MAP = {</span>
<span class="c1">#     &#39;da&#39;: &#39;danish&#39;,</span>
<span class="c1">#     &#39;nl&#39;: &#39;dutch&#39;,</span>
<span class="c1">#     &#39;fi&#39;: &#39;finnish&#39;,</span>
<span class="c1">#     &#39;fr&#39;: &#39;french&#39;,</span>
<span class="c1">#     &#39;de&#39;: &#39;german&#39;,</span>
<span class="c1">#     &#39;hu&#39;: &#39;hungarian&#39;,</span>
<span class="c1">#     &#39;it&#39;: &#39;italian&#39;,</span>
<span class="c1">#     &#39;no&#39;: &#39;norwegian&#39;,</span>
<span class="c1">#     &#39;pt&#39;: &#39;portuguese&#39;,</span>
<span class="c1">#     &#39;ro&#39;: &#39;romanian&#39;,</span>
<span class="c1">#     &#39;ru&#39;: &#39;russian&#39;,</span>
<span class="c1">#     &#39;es&#39;: &#39;spanish&#39;,</span>
<span class="c1">#     &#39;sv&#39;: &#39;swedish&#39;,</span>
<span class="c1">#     &#39;tr&#39;: &#39;turkish&#39;,</span>
<span class="c1">#     &#39;en&#39;: &#39;english&#39;</span>
<span class="c1"># }</span>
</pre></div>

<h2 id="deployment">Deployment<a class="headerlink" href="#deployment" title="Permanent link">&para;</a></h2>
<p>Explicates requires a server with PostgreSQL 10 (or higher) installed. The
recommended OS is Ubuntu 18.04. The guide following assumes you are starting
with a fresh Ubuntu 18.04 server.</p>
<p>Update and upgrade the package index:</p>
<div class="codehilite"><pre><span></span>sudo apt-get update
sudo apt-get upgrade
</pre></div>

<h3 id="install-python-and-git">Install Python and git<a class="headerlink" href="#install-python-and-git" title="Permanent link">&para;</a></h3>
<p>Install Python:</p>
<div class="codehilite"><pre><span></span>sudo apt install python
</pre></div>

<p>Install Python dependencies:</p>
<div class="codehilite"><pre><span></span>sudo apt install python-virtualenv python-dev python-setuptools python-pip
</pre></div>

<p>Install git:</p>
<div class="codehilite"><pre><span></span>sudo apt-get install git-core
</pre></div>

<h3 id="download-and-build-explicates">Download and build Explicates<a class="headerlink" href="#download-and-build-explicates" title="Permanent link">&para;</a></h3>
<p>Clone Explicates:</p>
<div class="codehilite"><pre><span></span>mkdir /var/www
git clone https://github.com/alexandermendes/explicates /var/www/explicates
</pre></div>

<p>Create a virtual environment:</p>
<div class="codehilite"><pre><span></span><span class="nb">cd</span> /var/www/explicates
virtualenv env
</pre></div>

<p>Activate the virtual environment:</p>
<div class="codehilite"><pre><span></span><span class="nb">source</span> env/bin/activate
</pre></div>

<p>Install Explicates:</p>
<div class="codehilite"><pre><span></span>pip install -r requirements.txt
</pre></div>

<p>Copy the settings template:</p>
<div class="codehilite"><pre><span></span>cp settings.py.tmpl settings.py
</pre></div>

<div class="admonition warning">
<p class="admonition-title">Important</p>
<p>You should edit the settings file to uncomment <code>ENV</code> and <code>SERVER_NAME</code>,
where the server name is the location of your production server.</p>
</div>
<p>Copy the alembic configuration:</p>
<div class="codehilite"><pre><span></span>cp alembic.ini.tmpl alembic.ini
</pre></div>

<h3 id="setup-the-database">Setup the database<a class="headerlink" href="#setup-the-database" title="Permanent link">&para;</a></h3>
<p>Install database dependencies:</p>
<div class="codehilite"><pre><span></span>sudo apt-get install postgresql postgresql-server-dev-all python-psycopg2 libpq-dev
</pre></div>

<p>Add a database user:</p>
<div class="codehilite"><pre><span></span>sudo -u postgres createuser -d -P explicates
</pre></div>

<p>Enter the password <code>tester</code> when prompted.</p>
<div class="admonition info">
<p class="admonition-title">Password choice</p>
<p>If you choose a different password you should also edit the database path
in <code>settings.py</code> and <code>alembic.ini</code>.</p>
</div>
<p>Create the database:</p>
<div class="codehilite"><pre><span></span>sudo -u postgres createdb explicates -O explicates
</pre></div>

<p>Populate the database:</p>
<div class="codehilite"><pre><span></span>python /var/www/explicates/bin/db_create.py
</pre></div>

<h3 id="setup-nginx">Setup NGINX<a class="headerlink" href="#setup-nginx" title="Permanent link">&para;</a></h3>
<p>Install NGINX:</p>
<div class="codehilite"><pre><span></span>sudo apt-get install nginx
</pre></div>

<p>Remove the default server configuration:</p>
<div class="codehilite"><pre><span></span>sudo rm -r /etc/nginx/sites-available/default
sudo rm -r /etc/nginx/sites-enabled/default
</pre></div>

<p>Edit a new server configuration file:</p>
<div class="codehilite"><pre><span></span>vim /etc/nginx/sites-available/explicates
</pre></div>

<p>Copy in the following and save the file:</p>
<div class="codehilite"><pre><span></span>server <span class="o">{</span>
  listen <span class="m">80</span> default_server<span class="p">;</span>
  listen <span class="o">[</span>::<span class="o">]</span>:80 default_server<span class="p">;</span>

  <span class="c1"># Change this to match your domain</span>
  server_name annotations.example.com<span class="p">;</span>

  client_body_buffer_size 10K<span class="p">;</span>
  client_header_buffer_size 1k<span class="p">;</span>
  client_max_body_size 10m<span class="p">;</span>
  large_client_header_buffers <span class="m">2</span> 1k<span class="p">;</span>

  gzip             on<span class="p">;</span>
  gzip_comp_level  <span class="m">2</span><span class="p">;</span>
  gzip_types       text/plain application/json application/ld+json<span class="p">;</span>
  gzip_min_length  <span class="m">1000</span><span class="p">;</span>
  gzip_proxied     expired no-cache no-store private auth<span class="p">;</span>

  location / <span class="o">{</span>
    expires -1<span class="p">;</span>
    include uwsgi_params<span class="p">;</span>
    uwsgi_pass unix:/tmp/explicates.sock<span class="p">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>

<p>Enable the Explicates configuration:</p>
<div class="codehilite"><pre><span></span>ln -s /etc/nginx/sites-available/explicates /etc/nginx/sites-enabled/explicates
</pre></div>

<p>Restart the NGINX server:</p>
<div class="codehilite"><pre><span></span>sudo service nginx restart
</pre></div>

<h3 id="setting-up-uwsgi">Setting up uWSGI<a class="headerlink" href="#setting-up-uwsgi" title="Permanent link">&para;</a></h3>
<p>Install uWSGI:</p>
<div class="codehilite"><pre><span></span>pip install -U uwsgi
</pre></div>

<p>Edit a new server configuration file:</p>
<div class="codehilite"><pre><span></span>vim /var/www/explicates/explicates.ini
</pre></div>

<p>Copy in the following and save the file:</p>
<div class="codehilite"><pre><span></span><span class="o">[</span>uwsgi<span class="o">]</span>
<span class="nv">socket</span> <span class="o">=</span> /tmp/explicates.sock
chmod-socket <span class="o">=</span> <span class="m">666</span>
<span class="nv">chdir</span> <span class="o">=</span> /var/www/explicates
<span class="nv">pythonpath</span> <span class="o">=</span> ..
<span class="nv">virtualenv</span> <span class="o">=</span> /var/www/explicates/env
<span class="nv">module</span> <span class="o">=</span> run:app
cpu-affinity <span class="o">=</span> <span class="m">1</span>
<span class="nv">processes</span> <span class="o">=</span> <span class="m">2</span>
<span class="nv">threads</span> <span class="o">=</span> <span class="m">2</span>
buffer-size <span class="o">=</span> <span class="m">65535</span>
</pre></div>

<h3 id="setup-up-supervisor">Setup Up Supervisor<a class="headerlink" href="#setup-up-supervisor" title="Permanent link">&para;</a></h3>
<p>Supervisor is used to run Explicates in the background and restart it when the
server boots up.</p>
<p>Install supervisor:</p>
<div class="codehilite"><pre><span></span>sudo apt-get install supervisor
</pre></div>

<p>Edit a new Supervisor program configuration:</p>
<div class="codehilite"><pre><span></span>vim /etc/supervisor/conf.d/explicates.conf
</pre></div>

<p>Copy in the following and save the file:</p>
<div class="codehilite"><pre><span></span><span class="k">[program:explicates]</span>
<span class="na">command</span><span class="o">=</span><span class="s">/var/www/explicates/env/bin/uwsgi /var/www/explicates/explicates.ini</span>
<span class="na">directory</span><span class="o">=</span><span class="s">/var/www/explicates</span>
<span class="na">autostart</span><span class="o">=</span><span class="s">true</span>
<span class="na">autorestart</span><span class="o">=</span><span class="s">true</span>
<span class="na">log_stdout</span><span class="o">=</span><span class="s">true</span>
<span class="na">log_stderr</span><span class="o">=</span><span class="s">true</span>
<span class="na">logfile</span><span class="o">=</span><span class="s">/var/log/explicates.log</span>
<span class="na">logfile_maxbytes</span><span class="o">=</span><span class="s">10MB</span>
<span class="na">logfile_backups</span><span class="o">=</span><span class="s">2</span>
</pre></div>

<p>Restart supervisor:</p>
<div class="codehilite"><pre><span></span>sudo service supervisor stop
sudo service supervisor start
</pre></div>

<p>Your Annotation server should now be running at
<a href="http://your.domain.com">http://your.domain.com</a>.</p>
<h3 id="security">Security<a class="headerlink" href="#security" title="Permanent link">&para;</a></h3>
<p>There are lots of potential steps that you could take to secure your servers.
Running through all of the options here is outside the scope of this guide,
but here are some quick wins for the LibCrowds and Explicates servers
(details might need to be modified a bit for the PYBOSSA server).</p>
<h4 id="firewall">Firewall<a class="headerlink" href="#firewall" title="Permanent link">&para;</a></h4>
<p>UFW, or Uncomplicated Firewall, is an easy way to manage a frontend firewall.</p>
<p>Install it:</p>
<div class="codehilite"><pre><span></span>sudo apt-get install ufw
</pre></div>

<p>Deny incoming and allow outgoing by default:</p>
<div class="codehilite"><pre><span></span>sudo ufw default deny incoming
sudo ufw default allow outgoing
</pre></div>

<p>Allow connections:</p>
<div class="codehilite"><pre><span></span>sudo ufw allow ssh
sudo ufw allow <span class="m">22</span>/tcp
</pre></div>

<p>Check the rules:</p>
<div class="codehilite"><pre><span></span>ufw status
</pre></div>

<p>You should see the following output:</p>
<div class="codehilite"><pre><span></span>To                         Action      From
--                         ------      ----
<span class="m">22</span>                         ALLOW       Anywhere
<span class="m">80</span>                         ALLOW       Anywhere
<span class="m">443</span>                        ALLOW       Anywhere
<span class="m">22</span> <span class="o">(</span>v6<span class="o">)</span>                    ALLOW       Anywhere <span class="o">(</span>v6<span class="o">)</span>
<span class="m">80</span> <span class="o">(</span>v6<span class="o">)</span>                    ALLOW       Anywhere <span class="o">(</span>v6<span class="o">)</span>
<span class="m">443</span> <span class="o">(</span>v6<span class="o">)</span>                   ALLOW       Anywhere <span class="o">(</span>v6<span class="o">)</span>
</pre></div>

<p>If the rules do indeed appear as above, enable the firewall:</p>
<div class="codehilite"><pre><span></span>sudo ufw <span class="nb">enable</span>
</pre></div>

<h4 id="secure-sockets-layer-ssl">Secure Sockets Layer (SSL)<a class="headerlink" href="#secure-sockets-layer-ssl" title="Permanent link">&para;</a></h4>
<p><a href="https://letsencrypt.org">Let's Encrypt</a> provide free SSL certificates. Use
the <a href="https://certbot.eff.org/">Certbot</a> client to set them up for your
operating system.</p>
<p>After following the Certbot guide, above, you can setup a scheduled task
to automatically renew the certificates.</p>
<p>Edit a new daily task:</p>
<div class="codehilite"><pre><span></span>vim /etc/cron.daily/certrenew
</pre></div>

<p>Copy in the following and save the file:</p>
<div class="codehilite"><pre><span></span>certbot renew
</pre></div>

<p>Make the file executable:</p>
<div class="codehilite"><pre><span></span>chmod +x /etc/cron.daily/certrenew
</pre></div>

<p>Your certificate should now be checked for renewal daily.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="Introduction" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Introduction
              </span>
            </div>
          </a>
        
        
          <a href="../collections/" title="Collections" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Collections
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.a59e2a89.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>